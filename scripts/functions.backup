backup_directory() {
	dir=$1
	bak=$2
	if [ -d $dir ]; then
		tar czf $bak $dir 2>/dev/null
	fi
}

backup_encrypt_directory() {
	temp_dir=$1
	target_dir=$2
	source_dir=$3
	target_file=$4
	if [ -d $source_dir ] && [ ! -h $source_dir ] && [ "`ls -A $source_dir`" != "" ]; then
		tar cf - $source_dir 2>/dev/null |gpg --encrypt --no-armor --recipient `gpg_backup_key` --output $temp_dir/$target_file.gpg --batch
		mv -f $temp_dir/$target_file.gpg $target_dir/$target_file.gpg 2>/dev/null
	fi
}

backup_encrypt_directory_daily() {
	if [ ! -f $3/.nobackup ] && [ ! -f $3/.weekly ]; then
		backup_encrypt_directory $1 $2 $3 $4
	fi
}

backup_encrypt_directory_weekly() {
	if [ ! -f $3/.nobackup ] && [ -f $3/.weekly ]; then
		backup_encrypt_directory $1 $2 $3 $4
	fi
}
